
  <!DOCTYPE html>
  <html>
    <head>
      <title>utils.ts</title>
      <link href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css" type="text/css" rel="stylesheet">
      <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/codemirror.min.js" type="text/javascript" charset="utf-8"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/mode/javascript/javascript.min.js" type="text/javascript" charset="utf-8"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/codemirror.min.css" type="text/css" rel="stylesheet">
<script src="../../../assets/source-file.js" type="text/javascript" charset="utf-8"></script>
<link href="../../../assets/source-file.css" type="text/css" rel="stylesheet">
    </head>
    <body>
    <div style="margin-top:3em" class="ui container"><h1 class="ui header"><a href="../../../index.html">TypeScript coverage report</a></h1><table style="margin-top:2em" class="ui celled table"><thead class=""><tr class=""><th class="">Filename</th><th class="">Percent</th><th class="">Threshold</th><th class="">Total</th><th class="">Covered</th><th class="">Uncovered</th></tr></thead><tbody class=""><tr class="positive"><td class="">src/sync/utils.ts</td><td class="">88.90%</td><td class="">0%</td><td class="">820</td><td class="">729</td><td class="">91</td></tr></tbody></table><textarea id="editor" readonly="" style="margin-top:3em">import { GRAPHQL_AUTH_MODE } from &#x27;@aws-amplify/api-graphql&#x27;;
import { GraphQLAuthError } from &#x27;@aws-amplify/api&#x27;;
import { Logger } from &#x27;@aws-amplify/core&#x27;;
import { ModelInstanceCreator } from &#x27;../datastore/datastore&#x27;;
import {
	AuthorizationRule,
	GraphQLCondition,
	GraphQLFilter,
	GraphQLField,
	isEnumFieldType,
	isGraphQLScalarType,
	isPredicateObj,
	isSchemaModel,
	isSchemaModelWithAttributes,
	isTargetNameAssociation,
	isNonModelFieldType,
	ModelFields,
	ModelInstanceMetadata,
	OpType,
	PersistentModel,
	PersistentModelConstructor,
	PredicatesGroup,
	RelationshipType,
	SchemaModel,
	SchemaNamespace,
	SchemaNonModel,
	ModelOperation,
	InternalSchema,
	AuthModeStrategy,
} from &#x27;../types&#x27;;
import {
	exhaustiveCheck,
	extractPrimaryKeyFieldNames,
	establishRelationAndKeys,
	IDENTIFIER_KEY_SEPARATOR,
} from &#x27;../util&#x27;;
import { MutationEvent } from &#x27;./&#x27;;

const logger = new Logger(&#x27;DataStore&#x27;);

enum GraphQLOperationType {
	LIST = &#x27;query&#x27;,
	CREATE = &#x27;mutation&#x27;,
	UPDATE = &#x27;mutation&#x27;,
	DELETE = &#x27;mutation&#x27;,
	GET = &#x27;query&#x27;,
}

export enum TransformerMutationType {
	CREATE = &#x27;Create&#x27;,
	UPDATE = &#x27;Update&#x27;,
	DELETE = &#x27;Delete&#x27;,
	GET = &#x27;Get&#x27;,
}

const dummyMetadata: ModelInstanceMetadata = {
	_version: undefined,
	_lastChangedAt: undefined,
	_deleted: undefined,
};

const metadataFields = &lt;(keyof ModelInstanceMetadata)[]&gt;(
	Object.keys(dummyMetadata)
);
export function getMetadataFields(): ReadonlyArray&lt;string&gt; {
	return metadataFields;
}

export function generateSelectionSet(
	namespace: SchemaNamespace,
	modelDefinition: SchemaModel | SchemaNonModel
): string {
	const scalarFields = getScalarFields(modelDefinition);
	const nonModelFields = getNonModelFields(namespace, modelDefinition);
	const implicitOwnerField = getImplicitOwnerField(
		modelDefinition,
		scalarFields
	);

	let scalarAndMetadataFields = Object.values(scalarFields)
		.map(({ name }) =&gt; name)
		.concat(implicitOwnerField)
		.concat(nonModelFields);

	if (isSchemaModel(modelDefinition)) {
		scalarAndMetadataFields = scalarAndMetadataFields
			.concat(getMetadataFields())
			.concat(getConnectionFields(modelDefinition, namespace));
	}

	const result = scalarAndMetadataFields.join(&#x27;\n&#x27;);

	return result;
}

function getImplicitOwnerField(
	modelDefinition: SchemaModel | SchemaNonModel,
	scalarFields: ModelFields
) {
	const ownerFields = getOwnerFields(modelDefinition);

	if (!scalarFields.owner &amp;&amp; ownerFields.includes(&#x27;owner&#x27;)) {
		return [&#x27;owner&#x27;];
	}
	return [];
}

function getOwnerFields(
	modelDefinition: SchemaModel | SchemaNonModel
): string[] {
	const ownerFields: string[] = [];
	if (isSchemaModelWithAttributes(modelDefinition)) {
		modelDefinition.attributes.forEach(attr =&gt; {
			if (attr.properties &amp;&amp; attr.properties.rules) {
				const rule = attr.properties.rules.find(rule =&gt; rule.allow === &#x27;owner&#x27;);
				if (rule &amp;&amp; rule.ownerField) {
					ownerFields.push(rule.ownerField);
				}
			}
		});
	}
	return ownerFields;
}

function getScalarFields(
	modelDefinition: SchemaModel | SchemaNonModel
): ModelFields {
	const { fields } = modelDefinition;

	const result = Object.values(fields)
		.filter(field =&gt; {
			if (isGraphQLScalarType(field.type) || isEnumFieldType(field.type)) {
				return true;
			}

			return false;
		})
		.reduce((acc, field) =&gt; {
			acc[field.name] = field;

			return acc;
		}, {} as ModelFields);

	return result;
}

// Used for generating the selection set for queries and mutations
function getConnectionFields(
	modelDefinition: SchemaModel,
	namespace: SchemaNamespace
): string[] {
	const result: string[] = [];

	Object.values(modelDefinition.fields)
		.filter(({ association }) =&gt; association &amp;&amp; Object.keys(association).length)
		.forEach(({ name, association }) =&gt; {
			const { connectionType } = association;

			switch (connectionType) {
				case &#x27;HAS_ONE&#x27;:
				case &#x27;HAS_MANY&#x27;:
					// Intentionally blank
					break;
				case &#x27;BELONGS_TO&#x27;:
					if (isTargetNameAssociation(association)) {
						// New codegen (CPK)
						if (association.targetNames &amp;&amp; association.targetNames.length &gt; 0) {
							// Need to retrieve relations in order to get connected model keys
							const [relations] = establishRelationAndKeys(namespace);

							const connectedModelName =
								modelDefinition.fields[name].type[&#x27;model&#x27;];

							const byPkIndex = relations[connectedModelName].indexes.find(
								([name]) =&gt; name === &#x27;byPk&#x27;
							);
							const keyFields = byPkIndex &amp;&amp; byPkIndex[1];
							const keyFieldSelectionSet = keyFields?.join(&#x27; &#x27;);

							// We rely on `_deleted` when we process the sync query (e.g. in batchSave in the adapters)
							result.push(`${name} { ${keyFieldSelectionSet} _deleted }`);
						} else {
							// backwards-compatability for schema generated prior to custom primary key support
							result.push(`${name} { id _deleted }`);
						}
					}
					break;
				default:
					exhaustiveCheck(connectionType);
			}
		});

	return result;
}

function getNonModelFields(
	namespace: SchemaNamespace,
	modelDefinition: SchemaModel | SchemaNonModel
): string[] {
	const result = [];

	Object.values(modelDefinition.fields).forEach(({ name, type }) =&gt; {
		if (isNonModelFieldType(type)) {
			const typeDefinition = namespace.nonModels![type.nonModel];
			const scalarFields = Object.values(getScalarFields(typeDefinition)).map(
				({ name }) =&gt; name
			);

			const nested = [];
			Object.values(typeDefinition.fields).forEach(field =&gt; {
				const { type, name } = field;

				if (isNonModelFieldType(type)) {
					const typeDefinition = namespace.nonModels![type.nonModel];

					nested.push(
						`${name} { ${generateSelectionSet(namespace, typeDefinition)} }`
					);
				}
			});

			result.push(`${name} { ${scalarFields.join(&#x27; &#x27;)} ${nested.join(&#x27; &#x27;)} }`);
		}
	});

	return result;
}

export function getAuthorizationRules(
	modelDefinition: SchemaModel
): AuthorizationRule[] {
	// Searching for owner authorization on attributes
	const authConfig = []
		.concat(modelDefinition.attributes)
		.find(attr =&gt; attr &amp;&amp; attr.type === &#x27;auth&#x27;);

	const { properties: { rules = [] } = {} } = authConfig || {};

	const resultRules: AuthorizationRule[] = [];
	// Multiple rules can be declared for allow: owner
	rules.forEach(rule =&gt; {
		// setting defaults for backwards compatibility with old cli
		const {
			identityClaim = &#x27;cognito:username&#x27;,
			ownerField = &#x27;owner&#x27;,
			operations = [&#x27;create&#x27;, &#x27;update&#x27;, &#x27;delete&#x27;, &#x27;read&#x27;],
			provider = &#x27;userPools&#x27;,
			groupClaim = &#x27;cognito:groups&#x27;,
			allow: authStrategy = &#x27;iam&#x27;,
			groups = [],
		} = rule;

		const isReadAuthorized = operations.includes(&#x27;read&#x27;);
		const isOwnerAuth = authStrategy === &#x27;owner&#x27;;

		if (!isReadAuthorized &amp;&amp; !isOwnerAuth) {
			return;
		}

		const authRule: AuthorizationRule = {
			identityClaim,
			ownerField,
			provider,
			groupClaim,
			authStrategy,
			groups,
			areSubscriptionsPublic: false,
		};

		if (isOwnerAuth) {
			// look for the subscription level override
			// only pay attention to the public level
			const modelConfig = (&lt;typeof modelDefinition.attributes&gt;[])
				.concat(modelDefinition.attributes)
				.find(attr =&gt; attr &amp;&amp; attr.type === &#x27;model&#x27;);

			// find the subscriptions level. ON is default
			const { properties: { subscriptions: { level = &#x27;on&#x27; } = {} } = {} } =
				modelConfig || {};

			// treat subscriptions as public for owner auth with unprotected reads
			// when `read` is omitted from `operations`
			authRule.areSubscriptionsPublic =
				!operations.includes(&#x27;read&#x27;) || level === &#x27;public&#x27;;
		}

		if (isOwnerAuth) {
			// owner rules has least priority
			resultRules.push(authRule);
			return;
		}

		resultRules.unshift(authRule);
	});

	return resultRules;
}

export function buildSubscriptionGraphQLOperation(
	namespace: SchemaNamespace,
	modelDefinition: SchemaModel,
	transformerMutationType: TransformerMutationType,
	isOwnerAuthorization: boolean,
	ownerField: string
): [TransformerMutationType, string, string] {
	const selectionSet = generateSelectionSet(namespace, modelDefinition);

	const { name: typeName, pluralName: pluralTypeName } = modelDefinition;

	const opName = `on${transformerMutationType}${typeName}`;
	let docArgs = &#x27;&#x27;;
	let opArgs = &#x27;&#x27;;

	if (isOwnerAuthorization) {
		docArgs = `($${ownerField}: String!)`;
		opArgs = `(${ownerField}: $${ownerField})`;
	}

	return [
		transformerMutationType,
		opName,
		`subscription operation${docArgs}{
			${opName}${opArgs}{
				${selectionSet}
			}
		}`,
	];
}

export function buildGraphQLOperation(
	namespace: SchemaNamespace,
	modelDefinition: SchemaModel,
	graphQLOpType: keyof typeof GraphQLOperationType
): [TransformerMutationType, string, string][] {
	let selectionSet = generateSelectionSet(namespace, modelDefinition);

	const { name: typeName, pluralName: pluralTypeName } = modelDefinition;

	let operation: string;
	let documentArgs: string = &#x27; &#x27;;
	let operationArgs: string = &#x27; &#x27;;
	let transformerMutationType: TransformerMutationType;

	switch (graphQLOpType) {
		case &#x27;LIST&#x27;:
			operation = `sync${pluralTypeName}`;
			documentArgs = `($limit: Int, $nextToken: String, $lastSync: AWSTimestamp, $filter: Model${typeName}FilterInput)`;
			operationArgs =
				&#x27;(limit: $limit, nextToken: $nextToken, lastSync: $lastSync, filter: $filter)&#x27;;
			selectionSet = `items {
							${selectionSet}
						}
						nextToken
						startedAt`;
			break;
		case &#x27;CREATE&#x27;:
			operation = `create${typeName}`;
			documentArgs = `($input: Create${typeName}Input!)`;
			operationArgs = &#x27;(input: $input)&#x27;;
			transformerMutationType = TransformerMutationType.CREATE;
			break;
		case &#x27;UPDATE&#x27;:
			operation = `update${typeName}`;
			documentArgs = `($input: Update${typeName}Input!, $condition: Model${typeName}ConditionInput)`;
			operationArgs = &#x27;(input: $input, condition: $condition)&#x27;;
			transformerMutationType = TransformerMutationType.UPDATE;
			break;
		case &#x27;DELETE&#x27;:
			operation = `delete${typeName}`;
			documentArgs = `($input: Delete${typeName}Input!, $condition: Model${typeName}ConditionInput)`;
			operationArgs = &#x27;(input: $input, condition: $condition)&#x27;;
			transformerMutationType = TransformerMutationType.DELETE;
			break;
		case &#x27;GET&#x27;:
			operation = `get${typeName}`;
			documentArgs = `($id: ID!)`;
			operationArgs = &#x27;(id: $id)&#x27;;
			transformerMutationType = TransformerMutationType.GET;
			break;

		default:
			exhaustiveCheck(graphQLOpType);
	}

	return [
		[
			transformerMutationType,
			operation,
			`${GraphQLOperationType[graphQLOpType]} operation${documentArgs}{
		${operation}${operationArgs}{
			${selectionSet}
		}
	}`,
		],
	];
}

export function createMutationInstanceFromModelOperation&lt;
	T extends PersistentModel
&gt;(
	relationships: RelationshipType,
	modelDefinition: SchemaModel,
	opType: OpType,
	model: PersistentModelConstructor&lt;T&gt;,
	element: T,
	condition: GraphQLCondition,
	MutationEventConstructor: PersistentModelConstructor&lt;MutationEvent&gt;,
	modelInstanceCreator: ModelInstanceCreator,
	id?: string
): MutationEvent {
	let operation: TransformerMutationType;

	switch (opType) {
		case OpType.INSERT:
			operation = TransformerMutationType.CREATE;
			break;
		case OpType.UPDATE:
			operation = TransformerMutationType.UPDATE;
			break;
		case OpType.DELETE:
			operation = TransformerMutationType.DELETE;
			break;
		default:
			exhaustiveCheck(opType);
	}

	// stringify nested objects of type AWSJSON
	// this allows us to return parsed JSON to users (see `castInstanceType()` in datastore.ts),
	// but still send the object correctly over the wire
	const replacer = (k, v) =&gt; {
		const isAWSJSON =
			k &amp;&amp;
			v !== null &amp;&amp;
			typeof v === &#x27;object&#x27; &amp;&amp;
			modelDefinition.fields[k] &amp;&amp;
			modelDefinition.fields[k].type === &#x27;AWSJSON&#x27;;

		if (isAWSJSON) {
			return JSON.stringify(v);
		}
		return v;
	};

	const modelId = getIdentifierValue(modelDefinition, element);
	const optionalId = OpType.INSERT &amp;&amp; id ? { id } : {};

	const mutationEvent = modelInstanceCreator(MutationEventConstructor, {
		...optionalId,
		data: JSON.stringify(element, replacer),
		modelId,
		model: model.name,
		operation,
		condition: JSON.stringify(condition),
	});

	return mutationEvent;
}

export function predicateToGraphQLCondition(
	predicate: PredicatesGroup&lt;any&gt;,
	modelDefinition: SchemaModel
): GraphQLCondition {
	const result = {};

	if (!predicate || !Array.isArray(predicate.predicates)) {
		return result;
	}

	const keyFields = extractPrimaryKeyFieldNames(modelDefinition);

	predicate.predicates.forEach(p =&gt; {
		if (isPredicateObj(p)) {
			const { field, operator, operand } = p;

			// This is compatible with how the GQL Transform currently generates the Condition Input,
			// i.e. any PK and SK fields are omitted and can&#x27;t be used as conditions.
			// However, I think this limits usability.
			// What if we want to delete all records where SK &gt; some value
			// Or all records where PK = some value but SKs are different values

			// TODO: if the Transform gets updated ^ we&#x27;ll need to modify this logic to only omit
			// key fields from the predicate/condition when ALL of the keyFields are present and using `eq` operators
			if (keyFields.includes(field as string)) {
				return;
			}

			result[field] = { [operator]: operand };
		} else {
			result[p.type] = predicateToGraphQLCondition(p, modelDefinition);
		}
	});

	return result;
}

export function predicateToGraphQLFilter(
	predicatesGroup: PredicatesGroup&lt;any&gt;
): GraphQLFilter {
	const result: GraphQLFilter = {};

	if (!predicatesGroup || !Array.isArray(predicatesGroup.predicates)) {
		return result;
	}

	const { type, predicates } = predicatesGroup;
	const isList = type === &#x27;and&#x27; || type === &#x27;or&#x27;;

	result[type] = isList ? [] : {};

	const appendToFilter = value =&gt;
		isList ? result[type].push(value) : (result[type] = value);

	predicates.forEach(predicate =&gt; {
		if (isPredicateObj(predicate)) {
			const { field, operator, operand } = predicate;

			const gqlField: GraphQLField = {
				[field]: { [operator]: operand },
			};

			appendToFilter(gqlField);
			return;
		}

		appendToFilter(predicateToGraphQLFilter(predicate));
	});

	return result;
}

export function getUserGroupsFromToken(
	token: { [field: string]: any },
	rule: AuthorizationRule
): string[] {
	// validate token against groupClaim
	let userGroups: string[] | string = token[rule.groupClaim] || [];

	if (typeof userGroups === &#x27;string&#x27;) {
		let parsedGroups;
		try {
			parsedGroups = JSON.parse(userGroups);
		} catch (e) {
			parsedGroups = userGroups;
		}
		userGroups = [].concat(parsedGroups);
	}

	return userGroups;
}

export async function getModelAuthModes({
	authModeStrategy,
	defaultAuthMode,
	modelName,
	schema,
}: {
	authModeStrategy: AuthModeStrategy;
	defaultAuthMode: GRAPHQL_AUTH_MODE;
	modelName: string;
	schema: InternalSchema;
}): Promise&lt;{
	[key in ModelOperation]: GRAPHQL_AUTH_MODE[];
}&gt; {
	const operations = Object.values(ModelOperation);

	const modelAuthModes: {
		[key in ModelOperation]: GRAPHQL_AUTH_MODE[];
	} = {
		CREATE: [],
		READ: [],
		UPDATE: [],
		DELETE: [],
	};

	try {
		await Promise.all(
			operations.map(async operation =&gt; {
				const authModes = await authModeStrategy({
					schema,
					modelName,
					operation,
				});

				if (typeof authModes === &#x27;string&#x27;) {
					modelAuthModes[operation] = [authModes];
				} else if (Array.isArray(authModes) &amp;&amp; authModes.length) {
					modelAuthModes[operation] = authModes;
				} else {
					// Use default auth mode if nothing is returned from authModeStrategy
					modelAuthModes[operation] = [defaultAuthMode];
				}
			})
		);
	} catch (error) {
		logger.debug(`Error getting auth modes for model: ${modelName}`, error);
	}
	return modelAuthModes;
}

export function getForbiddenError(error) {
	const forbiddenErrorMessages = [
		&#x27;Request failed with status code 401&#x27;,
		&#x27;Request failed with status code 403&#x27;,
	];
	let forbiddenError;
	if (error &amp;&amp; error.errors) {
		forbiddenError = (error.errors as [any]).find(err =&gt;
			forbiddenErrorMessages.includes(err.message)
		);
	} else if (error &amp;&amp; error.message) {
		forbiddenError = error;
	}

	if (forbiddenError) {
		return forbiddenError.message;
	}
	return null;
}

export function getClientSideAuthError(error) {
	const clientSideAuthErrors = Object.values(GraphQLAuthError);
	const clientSideError =
		error &amp;&amp;
		error.message &amp;&amp;
		clientSideAuthErrors.find(clientError =&gt;
			error.message.includes(clientError)
		);
	return clientSideError || null;
}

export async function getTokenForCustomAuth(
	authMode: GRAPHQL_AUTH_MODE,
	amplifyConfig: Record&lt;string, any&gt; = {}
): Promise&lt;string | undefined&gt; {
	if (authMode === GRAPHQL_AUTH_MODE.AWS_LAMBDA) {
		const {
			authProviders: { functionAuthProvider } = { functionAuthProvider: null },
		} = amplifyConfig;
		if (functionAuthProvider &amp;&amp; typeof functionAuthProvider === &#x27;function&#x27;) {
			try {
				const { token } = await functionAuthProvider();
				return token;
			} catch (error) {
				throw new Error(
					`Error retrieving token from \`functionAuthProvider\`: ${error}`
				);
			}
		} else {
			// TODO: add docs link once available
			throw new Error(
				`You must provide a \`functionAuthProvider\` function to \`DataStore.configure\` when using ${GRAPHQL_AUTH_MODE.AWS_LAMBDA}`
			);
		}
	}
}

// Util that takes a modelDefinition and model and returns either the id value(s) or the custom primary key value(s)
export function getIdentifierValue(
	modelDefinition: SchemaModel,
	model: ModelInstanceMetadata | PersistentModel
): string {
	const pkFieldNames = extractPrimaryKeyFieldNames(modelDefinition);

	const idOrPk = pkFieldNames
		.map(f =&gt; model[f])
		.join(IDENTIFIER_KEY_SEPARATOR);

	return idOrPk;
}
</textarea><pre id="annotations" style="display:none">[{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:113,&quot;character&quot;:42,&quot;text&quot;:&quot;rules&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:114,&quot;character&quot;:10,&quot;text&quot;:&quot;rule&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:114,&quot;character&quot;:33,&quot;text&quot;:&quot;rules&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:114,&quot;character&quot;:39,&quot;text&quot;:&quot;find&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:114,&quot;character&quot;:44,&quot;text&quot;:&quot;rule&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:114,&quot;character&quot;:52,&quot;text&quot;:&quot;rule&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:114,&quot;character&quot;:57,&quot;text&quot;:&quot;allow&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:115,&quot;character&quot;:8,&quot;text&quot;:&quot;rule&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:115,&quot;character&quot;:16,&quot;text&quot;:&quot;rule&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:115,&quot;character&quot;:21,&quot;text&quot;:&quot;ownerField&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:116,&quot;character&quot;:22,&quot;text&quot;:&quot;rule&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:116,&quot;character&quot;:27,&quot;text&quot;:&quot;ownerField&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:232,&quot;character&quot;:7,&quot;text&quot;:&quot;authConfig&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:234,&quot;character&quot;:8,&quot;text&quot;:&quot;attr&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:234,&quot;character&quot;:16,&quot;text&quot;:&quot;attr&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:234,&quot;character&quot;:24,&quot;text&quot;:&quot;attr&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:234,&quot;character&quot;:29,&quot;text&quot;:&quot;type&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:236,&quot;character&quot;:23,&quot;text&quot;:&quot;rules&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:240,&quot;character&quot;:1,&quot;text&quot;:&quot;rules&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:240,&quot;character&quot;:7,&quot;text&quot;:&quot;forEach&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:240,&quot;character&quot;:15,&quot;text&quot;:&quot;rule&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:243,&quot;character&quot;:3,&quot;text&quot;:&quot;identityClaim&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:244,&quot;character&quot;:3,&quot;text&quot;:&quot;ownerField&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:245,&quot;character&quot;:3,&quot;text&quot;:&quot;operations&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:246,&quot;character&quot;:3,&quot;text&quot;:&quot;provider&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:247,&quot;character&quot;:3,&quot;text&quot;:&quot;groupClaim&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:248,&quot;character&quot;:10,&quot;text&quot;:&quot;authStrategy&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:249,&quot;character&quot;:3,&quot;text&quot;:&quot;groups&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:252,&quot;character&quot;:8,&quot;text&quot;:&quot;isReadAuthorized&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:252,&quot;character&quot;:27,&quot;text&quot;:&quot;operations&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:252,&quot;character&quot;:38,&quot;text&quot;:&quot;includes&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:253,&quot;character&quot;:22,&quot;text&quot;:&quot;authStrategy&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:255,&quot;character&quot;:7,&quot;text&quot;:&quot;isReadAuthorized&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:277,&quot;character&quot;:42,&quot;text&quot;:&quot;level&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:283,&quot;character&quot;:5,&quot;text&quot;:&quot;operations&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:283,&quot;character&quot;:16,&quot;text&quot;:&quot;includes&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:283,&quot;character&quot;:36,&quot;text&quot;:&quot;level&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:429,&quot;character&quot;:19,&quot;text&quot;:&quot;k&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:429,&quot;character&quot;:22,&quot;text&quot;:&quot;v&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:431,&quot;character&quot;:3,&quot;text&quot;:&quot;k&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:432,&quot;character&quot;:3,&quot;text&quot;:&quot;v&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:433,&quot;character&quot;:10,&quot;text&quot;:&quot;v&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:434,&quot;character&quot;:26,&quot;text&quot;:&quot;k&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:435,&quot;character&quot;:26,&quot;text&quot;:&quot;k&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:438,&quot;character&quot;:25,&quot;text&quot;:&quot;v&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:440,&quot;character&quot;:9,&quot;text&quot;:&quot;v&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:472,&quot;character&quot;:28,&quot;text&quot;:&quot;operand&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:486,&quot;character&quot;:33,&quot;text&quot;:&quot;operand&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:509,&quot;character&quot;:24,&quot;text&quot;:&quot;value&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:510,&quot;character&quot;:29,&quot;text&quot;:&quot;value&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:514,&quot;character&quot;:28,&quot;text&quot;:&quot;operand&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:538,&quot;character&quot;:6,&quot;text&quot;:&quot;parsedGroups&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:540,&quot;character&quot;:3,&quot;text&quot;:&quot;parsedGroups&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:542,&quot;character&quot;:3,&quot;text&quot;:&quot;parsedGroups&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:541,&quot;character&quot;:11,&quot;text&quot;:&quot;e&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:544,&quot;character&quot;:25,&quot;text&quot;:&quot;parsedGroups&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:594,&quot;character&quot;:67,&quot;text&quot;:&quot;error&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:593,&quot;character&quot;:10,&quot;text&quot;:&quot;error&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:599,&quot;character&quot;:34,&quot;text&quot;:&quot;error&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:604,&quot;character&quot;:5,&quot;text&quot;:&quot;forbiddenError&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:605,&quot;character&quot;:5,&quot;text&quot;:&quot;error&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:605,&quot;character&quot;:14,&quot;text&quot;:&quot;error&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:605,&quot;character&quot;:20,&quot;text&quot;:&quot;errors&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:606,&quot;character&quot;:2,&quot;text&quot;:&quot;forbiddenError&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:606,&quot;character&quot;:20,&quot;text&quot;:&quot;error&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:606,&quot;character&quot;:26,&quot;text&quot;:&quot;errors&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:606,&quot;character&quot;:48,&quot;text&quot;:&quot;err&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:607,&quot;character&quot;:35,&quot;text&quot;:&quot;err&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:607,&quot;character&quot;:39,&quot;text&quot;:&quot;message&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:609,&quot;character&quot;:12,&quot;text&quot;:&quot;error&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:609,&quot;character&quot;:21,&quot;text&quot;:&quot;error&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:609,&quot;character&quot;:27,&quot;text&quot;:&quot;message&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:610,&quot;character&quot;:2,&quot;text&quot;:&quot;forbiddenError&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:610,&quot;character&quot;:19,&quot;text&quot;:&quot;error&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:613,&quot;character&quot;:5,&quot;text&quot;:&quot;forbiddenError&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:614,&quot;character&quot;:9,&quot;text&quot;:&quot;forbiddenError&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:614,&quot;character&quot;:24,&quot;text&quot;:&quot;message&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:619,&quot;character&quot;:39,&quot;text&quot;:&quot;error&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:622,&quot;character&quot;:2,&quot;text&quot;:&quot;error&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:623,&quot;character&quot;:2,&quot;text&quot;:&quot;error&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:623,&quot;character&quot;:8,&quot;text&quot;:&quot;message&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:625,&quot;character&quot;:3,&quot;text&quot;:&quot;error&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:625,&quot;character&quot;:9,&quot;text&quot;:&quot;message&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:625,&quot;character&quot;:17,&quot;text&quot;:&quot;includes&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:636,&quot;character&quot;:20,&quot;text&quot;:&quot;functionAuthProvider&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:638,&quot;character&quot;:6,&quot;text&quot;:&quot;functionAuthProvider&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:638,&quot;character&quot;:37,&quot;text&quot;:&quot;functionAuthProvider&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:640,&quot;character&quot;:12,&quot;text&quot;:&quot;token&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:640,&quot;character&quot;:28,&quot;text&quot;:&quot;functionAuthProvider&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:644,&quot;character&quot;:62,&quot;text&quot;:&quot;error&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src/sync/utils.ts&quot;,&quot;line&quot;:642,&quot;character&quot;:12,&quot;text&quot;:&quot;error&quot;,&quot;kind&quot;:1}]</pre></div>
    <p class="footer-text">TypeScript Coverage Report generated by <a href="https://github.com/plantain-00/type-coverage">type-coverage</a> and <a href="https://github.com/alexcanessa/typescript-coverage-report">typescript-coverage-report</a> at Mon, 17 Oct 2022 20:15:29 GMT</p>
    </body>
  </html>
  